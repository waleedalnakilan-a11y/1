local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Main Window
local Window = Rayfield:CreateWindow({
   Name = "KZ HUB V2 / BY-Waleed",
   LoadingTitle = "KZ HUB V2",
   LoadingSubtitle = "Hitbox + ESP + Movement",
   Theme = "Dark",
})

-- Tabs
local CombatTab = Window:CreateTab("âš”ï¸ Combat", 6323598516)
local VisualTab = Window:CreateTab("ğŸ‘ï¸ Visuals", 6034509993)
local MovementTab = Window:CreateTab("ğŸƒ Movement", 6034509993)

------------------------------------------------------
-- ğŸ”¥ HITBOX EXTENDER (ÙŠØ¨Ù‚Ù‰ Ø´ØºØ§Ù„ Ø¯Ø§ÙŠÙ…)
------------------------------------------------------

local HitboxEnabled = false
local HitboxSize = 2

-- Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‡ÙŠØªÙˆØ¨ÙƒØ³
local function updateHitboxes()
    if not HitboxEnabled then return end -- Ù„Ùˆ Ø·Ø§ÙÙŠ Ù„Ø§ ØªØ³ÙˆÙŠ Ø´ÙŠ
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local hrp = player.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                pcall(function()
                    hrp.Size = Vector3.new(HitboxSize, HitboxSize, HitboxSize)
                    hrp.Transparency = 0.7
                end)
            end
        end
    end
end

-- Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‡ÙŠØªÙˆØ¨ÙƒØ³ Ù„Ù„Ø·Ø¨ÙŠØ¹ÙŠ
local function resetHitboxes()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local hrp = player.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                pcall(function()
                    hrp.Size = Vector3.new(2, 2, 1) -- Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
                    hrp.Transparency = 0
                end)
            end
        end
    end
end

-- Ø¯Ø§Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‡ÙŠØªÙˆØ¨ÙƒØ³ Ø¹Ù„Ù‰ Ø´Ø®ØµÙŠØ© Ù…Ø¹ÙŠÙ†Ø©
local function applyHitboxToCharacter(character)
    if not HitboxEnabled then return end
    if not character or not character:IsA("Model") then return end
    
    local player = Players:GetPlayerFromCharacter(character)
    if not player or player == LocalPlayer then return end
    
    task.wait(0.5) -- Ù†Ù†ØªØ¸Ø± Ø´ÙˆÙŠ Ø¹Ø´Ø§Ù† ÙŠØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ø®ØµÙŠØ©
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if hrp then
        pcall(function()
            hrp.Size = Vector3.new(HitboxSize, HitboxSize, HitboxSize)
            hrp.Transparency = 0.7
        end)
    end
end

-- Toggle ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù‡ÙŠØªÙˆØ¨ÙƒØ³
CombatTab:CreateToggle({
   Name = "Enable Hitbox Extender",
   CurrentValue = false,
   Callback = function(Value)
      HitboxEnabled = Value
      if Value then
         -- Ø¥Ø°Ø§ Ø´ØºÙ„Ù†Ø§Ù‡ØŒ Ù†Ø·Ø¨Ù‚ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
         updateHitboxes()
         Rayfield:Notify({
            Title = "Hitbox",
            Content = "ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù‡ÙŠØªÙˆØ¨ÙƒØ³",
            Duration = 2,
         })
      else
         -- Ø¥Ø°Ø§ Ø·ÙÙŠÙ†Ø§Ù‡ØŒ Ù†Ø±Ø¬Ø¹ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
         resetHitboxes()
         Rayfield:Notify({
            Title = "Hitbox",
            Content = "ØªÙ… Ø¥Ù„ØºØ§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù‡ÙŠØªÙˆØ¨ÙƒØ³",
            Duration = 2,
         })
      end
   end,
})

-- Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø­Ø¬Ù…
CombatTab:CreateSlider({
   Name = "Hitbox Size",
   Range = {1, 200},
   Increment = 0.5,
   Suffix = "x",
   CurrentValue = HitboxSize,
   Callback = function(Value)
      HitboxSize = Value
      if HitboxEnabled then
         updateHitboxes() -- Ù†Ø­Ø¯Ø« Ø§Ù„Ø£Ø­Ø¬Ø§Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù„
      end
   end,
})

-- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¬Ø¯Ø¯
Players.PlayerAdded:Connect(function(player)
    if player ~= LocalPlayer then
        -- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¥Ø¶Ø§ÙØ© Ø´Ø®ØµÙŠØ© Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
        player.CharacterAdded:Connect(function(character)
            applyHitboxToCharacter(character)
        end)
        
        -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ù†Ø¯Ù‡ Ø´Ø®ØµÙŠØ© Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        if player.Character then
            applyHitboxToCharacter(player.Character)
        end
    end
end)

-- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
for _, player in pairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        -- Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ†
        player.CharacterAdded:Connect(function(character)
            applyHitboxToCharacter(character)
        end)
        
        -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ù†Ø¯Ù‡ Ø´Ø®ØµÙŠØ© Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        if player.Character then
            applyHitboxToCharacter(player.Character)
        end
    end
end

-- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¥Ø°Ø§ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù†Ø¶Ø±Ø¨Øª Ø£Ùˆ ØªØºÙŠØ±Øª (Ù…Ø«Ù„Ø§Ù‹ Ù„Ù…Ø§ ØªÙ…ÙˆØª)
LocalPlayer.CharacterAdded:Connect(function()
    -- Ù‡Ù†Ø§ Ù†Ø¶Ù…Ù† Ø¥Ù† Ø§Ù„Ù‡ÙŠØªÙˆØ¨ÙƒØ³ ÙŠØ±Ø¬Ø¹ ÙŠØ´ØªØºÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ø¹Ø¯ Ù…Ø§ Ù†Ø±Ø¬Ø¹ Ù†Ø¨Ø¹Ø«
    if HitboxEnabled then
        task.wait(1) -- Ù†Ù†ØªØ¸Ø± Ø´ÙˆÙŠ Ø¹Ø´Ø§Ù† Ø§Ù„Ù„ÙˆØ¯ÙŠÙ†Ù‚
        updateHitboxes()
    end
end)

------------------------------------------------------
-- ğŸ‘ï¸ PLAYER ESP
------------------------------------------------------

local ESPHolders = {}
local ESPEnabled = false

local function safeCreateESP(player)
    if player == LocalPlayer or ESPHolders[player] then return end
    
    local holder = Instance.new("Folder")
    holder.Name = player.Name.."_ESP"
    holder.Parent = game.CoreGui
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "Highlight"
    highlight.Parent = holder
    
    local teamColor = Color3.new(1, 0, 0)
    if player.Team and LocalPlayer.Team then
        teamColor = player.Team == LocalPlayer.Team and Color3.new(0, 1, 0) or Color3.new(1, 0, 0)
    end
    
    highlight.FillColor = teamColor
    highlight.OutlineColor = Color3.new(1, 1, 1)
    
    if player.Character then
        highlight.Adornee = player.Character
    end
    
    player.CharacterAdded:Connect(function(character)
        task.wait(1)
        highlight.Adornee = character
    end)
    
    ESPHolders[player] = holder
end

VisualTab:CreateToggle({
   Name = "Player ESP",
   CurrentValue = false,
   Callback = function(Value)
      ESPEnabled = Value
      
      if Value then
         for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                safeCreateESP(player)
            end
         end

         Players.PlayerAdded:Connect(function(player)
            if ESPEnabled then
                safeCreateESP(player)
            end
         end)
      else
         for player, holder in pairs(ESPHolders) do
            pcall(function()
                holder:Destroy()
            end)
         end
         ESPHolders = {}
      end
   end,
})

Players.PlayerRemoving:Connect(function(player)
    if ESPHolders[player] then
        pcall(function()
            ESPHolders[player]:Destroy()
        end)
        ESPHolders[player] = nil
    end
end)

------------------------------------------------------
-- ğŸƒ MOVEMENT FEATURES
------------------------------------------------------

-- Speed Changer (Ø³Ù„Ø§ÙŠØ¯Ø± Ø³Ø±Ø¹Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨)
local SpeedEnabled = false
local SpeedValue = 16

MovementTab:CreateToggle({
   Name = "Enable Speed Changer",
   CurrentValue = false,
   Callback = function(Value)
      SpeedEnabled = Value
      if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.WalkSpeed = Value and SpeedValue or 16
      end
   end,
})

MovementTab:CreateSlider({
   Name = "Walk Speed",
   Range = {16, 100},
   Increment = 1,
   Suffix = "Speed",
   CurrentValue = SpeedValue,
   Callback = function(Value)
      SpeedValue = Value
      if SpeedEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.WalkSpeed = Value
      end
   end,
})

-- Infinite Jump
local InfiniteJumpEnabled = false

MovementTab:CreateToggle({
   Name = "Infinite Jump",
   CurrentValue = false,
   Callback = function(Value)
      InfiniteJumpEnabled = Value
   end,
})

UserInputService.JumpRequest:Connect(function()
   if InfiniteJumpEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
      LocalPlayer.Character.Humanoid:ChangeState("Jumping")
   end
end)

-- Fly Mode (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… CFrame)
local FlyEnabled = false
local FlySpeed = 50
local FlyConnection = nil
local BodyGyro, BodyVelocity

local function toggleFly()
   if FlyEnabled then
      -- ØªØ´ØºÙŠÙ„ Ø§Ù„Ø·ÙŠØ±Ø§Ù†
      local character = LocalPlayer.Character
      if not character then return end
      
      local humanoid = character:FindFirstChild("Humanoid")
      local rootPart = character:FindFirstChild("HumanoidRootPart")
      
      if not humanoid or not rootPart then return end
      
      humanoid.PlatformStand = true
      
      BodyGyro = Instance.new("BodyGyro")
      BodyGyro.P = 9e4
      BodyGyro.MaxTorque = Vector3.new(9e4, 9e4, 9e4)
      BodyGyro.CFrame = rootPart.CFrame
      BodyGyro.Parent = rootPart
      
      BodyVelocity = Instance.new("BodyVelocity")
      BodyVelocity.Velocity = Vector3.new(0, 0, 0)
      BodyVelocity.MaxForce = Vector3.new(9e4, 9e4, 9e4)
      BodyVelocity.Parent = rootPart
      
      FlyConnection = RunService.RenderStepped:Connect(function()
         if not FlyEnabled or not character or not rootPart then
            toggleFly()
            return
         end
         
         local moveDirection = Vector3.new(0, 0, 0)
         
         if UserInputService:IsKeyDown(Enum.KeyCode.W) then
            moveDirection = moveDirection + (workspace.CurrentCamera.CFrame.LookVector * FlySpeed)
         end
         if UserInputService:IsKeyDown(Enum.KeyCode.S) then
            moveDirection = moveDirection - (workspace.CurrentCamera.CFrame.LookVector * FlySpeed)
         end
         if UserInputService:IsKeyDown(Enum.KeyCode.A) then
            moveDirection = moveDirection - (workspace.CurrentCamera.CFrame.RightVector * FlySpeed)
         end
         if UserInputService:IsKeyDown(Enum.KeyCode.D) then
            moveDirection = moveDirection + (workspace.CurrentCamera.CFrame.RightVector * FlySpeed)
         end
         if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            moveDirection = moveDirection + Vector3.new(0, FlySpeed, 0)
         end
         if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
            moveDirection = moveDirection - Vector3.new(0, FlySpeed, 0)
         end
         
         BodyVelocity.Velocity = moveDirection
         BodyGyro.CFrame = workspace.CurrentCamera.CFrame
      end)
      
   else
      -- Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø·ÙŠØ±Ø§Ù†
      if FlyConnection then
         FlyConnection:Disconnect()
         FlyConnection = nil
      end
      
      if BodyGyro then
         BodyGyro:Destroy()
         BodyGyro = nil
      end
      
      if BodyVelocity then
         BodyVelocity:Destroy()
         BodyVelocity = nil
      end
      
      if LocalPlayer.Character then
         local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
         if humanoid then
            humanoid.PlatformStand = false
         end
      end
   end
end

MovementTab:CreateToggle({
   Name = "Fly Mode (CFrame)",
   CurrentValue = false,
   Callback = function(Value)
      FlyEnabled = Value
      toggleFly()
   end,
})

MovementTab:CreateSlider({
   Name = "Fly Speed",
   Range = {10, 200},
   Increment = 5,
   Suffix = "Speed",
   CurrentValue = FlySpeed,
   Callback = function(Value)
      FlySpeed = Value
   end,
})

-- Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø®ØµÙŠØ© (Ù„Ù„Ù…ÙˆØª)
LocalPlayer.CharacterAdded:Connect(function(character)
   task.wait(1)
   
   -- Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø±Ø¹Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØ¹Ù„Ø©
   if SpeedEnabled and character:FindFirstChild("Humanoid") then
      character.Humanoid.WalkSpeed = SpeedValue
   end
   
   -- Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø¨ÙŠÙ†Ø·ÙÙ‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ù…ÙˆØªØŒ ÙˆÙ‡Ø°Ø§ Ø·Ø¨ÙŠØ¹ÙŠ
end)

------------------------------------------------------
-- LOADED MESSAGE
------------------------------------------------------

Rayfield:Notify({
   Title = "KZ HUB V2 Loaded",
   Content = "Hitbox + ESP + Movement Features",
   Duration = 4,
})
